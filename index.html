<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rental Application for 8809 Amigos Pl, Riverside, CA</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.5.2/dist/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f4f4f4;
        }
        .container {
            max-width: 800px;
            margin: auto;
            background: #fff;
            padding: 20px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }
        h1 {
            text-align: center;
            color: #333;
        }
        label {
            display: block;
            margin-top: 10px;
        }
        input, textarea, select {
            width: 100%;
            padding: 10px;
            margin-top: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
        }
        button {
            display: block;
            width: 100%;
            padding: 10px;
            background-color: #5cb85c;
            color: white;
            border: none;
            border-radius: 4px;
            margin-top: 20px;
            font-size: 16px;
        }
        button:hover {
            background-color: #4cae4c;
        }
        .conditional-section {
            display: none;
        }
        .remove-button {
            background-color: #d9534f;
            margin-top: 10px;
        }
        .remove-button:hover {
            background-color: #c9302c;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Rental Application for 8809 Amigos Pl, Riverside, CA</h1>
        <!-- Bootstrap Carousel -->
        <div id="houseCarousel" class="carousel slide" data-ride="carousel">
            <div class="carousel-inner">
                <!-- Carousel items go here -->
                <div class="carousel-item active">
                    <img src="static/1.jpg" class="d-block w-100" alt="House photo 1">
                </div>
                <div class="carousel-item">
                    <img src="static/2.jpg" class="d-block w-100" alt="House photo 2">
                </div>
                <div class="carousel-item">
                    <img src="static/3.jpg" class="d-block w-100" alt="House photo 3">
                </div>
                <div class="carousel-item">
                    <img src="static/4.jpg" class="d-block w-100" alt="House photo 4">
                </div>
                <div class="carousel-item">
                    <img src="static/5.jpg" class="d-block w-100" alt="House photo 5">
                </div>
                <div class="carousel-item">
                    <img src="static/6.jpg" class="d-block w-100" alt="House photo 6">
                </div>
                <div class="carousel-item">
                    <img src="static/7.jpg" class="d-block w-100" alt="House photo 7">
                </div>
                <div class="carousel-item">
                    <img src="static/8.jpg" class="d-block w-100" alt="House photo 8">
                </div>
                <div class="carousel-item">
                    <img src="static/9.jpg" class="d-block w-100" alt="House photo 9">
                </div>
                <div class="carousel-item">
                    <img src="static/10.jpg" class="d-block w-100" alt="House photo 10">
                </div>
                <div class="carousel-item">
                    <img src="static/11.jpg" class="d-block w-100" alt="House photo 11">
                </div>
                <div class="carousel-item">
                    <img src="static/12.jpg" class="d-block w-100" alt="House photo 12">
                </div>
                <div class="carousel-item">
                    <img src="static/13.jpg" class="d-block w-100" alt="House photo 13">
                </div>
                <div class="carousel-item">
                    <img src="static/14.jpg" class="d-block w-100" alt="House photo 14">
                </div>
                <div class="carousel-item">
                    <img src="static/15.jpg" class="d-block w-100" alt="House photo 15">
                </div>
                <div class="carousel-item">
                    <img src="static/16.jpg" class="d-block w-100" alt="House photo 16">
                </div>
                <div class="carousel-item">
                    <img src="static/17.jpg" class="d-block w-100" alt="House photo 17">
                </div>
                <div class="carousel-item">
                    <img src="static/18.jpg" class="d-block w-100" alt="House photo 18">
                </div>
                <div class="carousel-item">
                    <img src="static/19.jpg" class="d-block w-100" alt="House photo 19">
                </div>
                <div class="carousel-item">
                    <img src="static/20.jpg" class="d-block w-100" alt="House photo 20">
                </div>
            </div>
            <a class="carousel-control-prev" href="#houseCarousel" role="button" data-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="sr-only">Previous</span>
            </a>
            <a class="carousel-control-next" href="#houseCarousel" role="button" data-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="sr-only">Next</span>
            </a>
        </div>
        <p>Welcome to the rental application for 8809 Amigos Pl, Riverside, CA. Please fill out the following form with accurate and complete information. Note that all individuals over the age of 18 must be included on this application as an adult.</p>

        <!-- Application Form -->
        <form id="rentalForm" action="process_application.php" method="post" enctype="multipart/form-data">
            <!-- Existing form content -->
            <div id="onlineApplicationSection">
                <div id="adultsSection">
                    <!-- Initial adult form section -->
                    <div class="adult" data-index="1">
                        <h2>Personal Information (Adult 1)</h2>
                        <fieldset>
                            <legend>Personal Information</legend>
                            <label for="full_name_1">Full Name:</label>
                            <input type="text" id="full_name_1" name="full_name[]" required>
                            
                            <label for="email_1">Email:</label>
                            <input type="email" id="email_1" name="email[]" pattern="[^@ \t\r\n]+@[^@ \t\r\n]+\.[^@ \t\r\n]+" title="Please enter a valid email address." required>
                            
                            <label for="phone_1">Phone Number:</label>
                            <input type="tel" id="phone_1" name="phone[]" required>
                            
                            <label for="dob_1">Date of Birth:</label>
                            <input type="date" id="dob_1" name="dob[]" required>
                            
                            <label for="ssn_itin_1">Social Security Number (SSN) or Individual Taxpayer Identification Number (ITIN):</label>
                            <input type="text" id="ssn_itin_1" name="ssn_itin[]" required>
                            
                            <label for="drivers_license_1">Driver's License Number:</label>
                            <input type="text" id="drivers_license_1" name="drivers_license[]">
                            
                            <label for="id_photo_1">Upload a Photo of Your ID (Driver's license, Passport, or any form of ID, showing the front):</label>
                            <input type="file" id="id_photo_1" name="id_photo[]" accept="image/*" required>
                        </fieldset>

                        <fieldset>
                            <legend>Current Residence</legend>
                            <label for="current_address_1">Current Address:</label>
                            <input type="text" id="current_address_1" name="current_address[]" required>
                            
                            <label for="current_rent_1">Current Rent Amount:</label>
                            <input type="number" id="current_rent_1" name="current_rent[]" required>
                            
                            <label for="current_landlord_1">Current Landlord's Name:</label>
                            <input type="text" id="current_landlord_1" name="current_landlord[]" required>
                            
                            <label for="landlord_phone_1">Current Landlord's Phone:</label>
                            <input type="tel" id="landlord_phone_1" name="landlord_phone[]" required>
                            
                            <label for="reason_for_leaving_1">Reason for Leaving:</label>
                            <textarea id="reason_for_leaving_1" name="reason_for_leaving[]" required></textarea>
                        </fieldset>

                        <fieldset>
                            <legend>Employment Information</legend>
                            <label for="employed_1">Are you currently employed?</label>
                            <select id="employed_1" name="employed[]" onchange="toggleEmploymentFields(this)">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>

                            <div class="employment-fields conditional-section">
                                <label for="employer_1">Employer:</label>
                                <input type="text" id="employer_1" name="employer[]">
                                
                                <label for="employer_address_1">Employer Address:</label>
                                <input type="text" id="employer_address_1" name="employer_address[]">
                                
                                <label for="position_1">Position:</label>
                                <input type="text" id="position_1" name="position[]">
                                
                                <label for="salary_1">Monthly Salary:</label>
                                <input type="number" id="salary_1" name="salary[]">
                                
                                <label for="employment_duration_1">Duration of Employment:</label>
                                <input type="text" id="employment_duration_1" name="employment_duration[]">
                                
                                <label for="supervisor_name_1">Supervisor's Name:</label>
                                <input type="text" id="supervisor_name_1" name="supervisor_name[]">
                                
                                <label for="supervisor_phone_1">Supervisor's Phone:</label>
                                <input type="tel" id="supervisor_phone_1" name="supervisor_phone[]">
                            </div>
                        </fieldset>

                        <fieldset>
                            <legend>Section 8 Housing Voucher</legend>
                            <label for="section8_1">Do you have a Section 8 Housing Voucher?</label>
                            <select id="section8_1" name="section8[]" onchange="toggleSection8Fields(this)">
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>

                            <div class="section8-fields conditional-section">
                                <label for="voucher_amount_1">Voucher Amount:</label>
                                <input type="number" id="voucher_amount_1" name="voucher_amount[]">
                                
                                <label for="voucher_case_worker_1">Case Worker’s Name:</label>
                                <input type="text" id="voucher_case_worker_1" name="voucher_case_worker[]">
                                
                                <label for="case_worker_phone_1">Case Worker’s Phone:</label>
                                <input type="tel" id="case_worker_phone_1" name="case_worker_phone[]">
                            </div>
                        </fieldset>

                        <fieldset>
                            <legend>Legal and Background Information</legend>
                            <label for="eviction_history_1">Have you ever been evicted?</label>
                            <select id="eviction_history_1" name="eviction_history[]" required>
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>
                            
                            <label for="bankruptcy_history_1">Have you ever filed for bankruptcy?</label>
                            <select id="bankruptcy_history_1" name="bankruptcy_history[]" required>
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>
                            
                            <label for="criminal_history_1">Do you have any criminal convictions?</label>
                            <select id="criminal_history_1" name="criminal_history[]" required>
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                            </select>
                            
                            <label for="additional_info_1">Additional Information:</label>
                            <textarea id="additional_info_1" name="additional_info[]"></textarea>
                        </fieldset>

                        <button type="button" class="remove-button" onclick="removeAdult(this)">Remove This Adult</button>
                    </div>
                </div>

                <button type="button" id="addAdultButton">Add Another Adult</button>

                <!-- Minors Section: Ask about minors in the household -->
                <fieldset>
                    <legend>Minors</legend>
                    <label for="minors">Will there be any minors (under 18) staying at the residence?</label>
                    <select id="minors" name="minors" class="form-control" required onchange="toggleMinorDetails(this)">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                    
                    <div id="minorDetails" class="conditional-section">
                        <label for="minor_names_ages">Please provide the names and ages of the minors:</label>
                        <textarea id="minor_names_ages" name="minor_names_ages" class="form-control"></textarea>
                    </div>
                </fieldset>

                <!-- Pets Section: Universal for the household -->
                <fieldset>
                    <legend>Pets</legend>
                    <label for="pets">Do you have any pets?</label>
                    <select id="pets" name="pets" class="form-control" required onchange="togglePetDetails(this)">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                    
                    <div id="petDetails" class="conditional-section">
                        <label for="pet_details">If yes, please provide details:</label>
                        <textarea id="pet_details" name="pet_details" class="form-control"></textarea>
                    </div>
                </fieldset>

                <fieldset>
                    <legend>Proof of Income</legend>
                    <label for="proof_of_income">Upload Proof of Income (last 2-3 months of pay stubs):</label>
                    <input type="file" id="proof_of_income" name="proof_of_income[]" multiple>
                </fieldset>

                <fieldset>
                    <legend>Bank Statements</legend>
                    <label for="bank_statements">Upload Bank Statements (last 2-3 months):</label>
                    <input type="file" id="bank_statements" name="bank_statements[]" multiple>
                </fieldset>

                <fieldset>
                    <legend>Other Documents</legend>
                    <label for="other_documents">Upload Other Documents (Payment Proof, etc.):</label>
                    <input type="file" id="other_documents" name="other_documents[]" multiple>
                </fieldset>

                <fieldset>
                    <legend>Agreement and Authorization</legend>
                    <p>The rental price starts at $2,800. If you are applying with a Section 8 voucher, the rental price will be adjusted based on the voucher amount and local payment standards as determined by the Public Housing Authority. Your portion of the rent will be determined accordingly.</p>
                    <p>By submitting this application, I certify that all information is true and correct. I authorize the landlord to verify the information provided, including running a credit report and background check. I understand that a non-refundable fee may be required for these checks.</p>
                    <label for="signature">Signature:</label>
                    <input type="text" id="signature" name="signature" required>
                    
                    <label for="application_date">Date:</label>
                    <input type="date" id="application_date" name="application_date" required>
                </fieldset>
                
                <div id="feeSummary">
                    <p>Total Application Fee: $<span id="totalFee">0.10</span></p>
                </div>

                <div id="card-element">
                    <!-- Stripe Elements will be inserted here -->
                </div>
                <div id="card-errors" role="alert"></div>
                
                <button type="submit">Submit Application</button>
            </div>
        </form>
    </div>

    <script src="https://js.stripe.com/v3/"></script>
    <script>
        const stripe = Stripe('YOUR_STRIPE_PUBLIC_KEY'); // Replace with your actual Stripe public key
        const elements = stripe.elements();

        // Create and mount card element for online section
        const cardElement = elements.create('card');
        cardElement.mount('#card-element');

        let adultCount = 1;
        const feePerAdult = 0.10;
        document.getElementById('addAdultButton').addEventListener('click', function() {
            adultCount++;
            const newAdultSection = document.createElement('div');
            newAdultSection.classList.add('adult');
            newAdultSection.setAttribute('data-index', adultCount);
            newAdultSection.innerHTML = `
                <h2>Personal Information (Adult ${adultCount})</h2>
                <fieldset>
                    <legend>Personal Information</legend>
                    <label for="full_name_${adultCount}">Full Name:</label>
                    <input type="text" id="full_name_${adultCount}" name="full_name[]" required>
                    
                    <label for="email_${adultCount}">Email:</label>
                    <input type="email" id="email_${adultCount}" name="email[]" pattern="[^@ \t\r\n]+@[^@ \t\r\n]+\.[^@ \t\r\n]+" title="Please enter a valid email address." required>
                    
                    <label for="phone_${adultCount}">Phone Number:</label>
                    <input type="tel" id="phone_${adultCount}" name="phone[]" required>
                    
                    <label for="dob_${adultCount}">Date of Birth:</label>
                    <input type="date" id="dob_${adultCount}" name="dob[]" required>
                    
                    <label for="ssn_itin_${adultCount}">Social Security Number (SSN) or Individual Taxpayer Identification Number (ITIN):</label>
                    <input type="text" id="ssn_itin_${adultCount}" name="ssn_itin[]" required>
                    
                    <label for="drivers_license_${adultCount}">Driver's License Number:</label>
                    <input type="text" id="drivers_license_${adultCount}" name="drivers_license[]">
                    
                    <label for="id_photo_${adultCount}">Upload a Photo of Your ID (Driver's license, Passport, or any form of ID, showing front):</label>
                    <input type="file" id="id_photo_${adultCount}" name="id_photo[]" accept="image/*" required>
                </fieldset>

                <fieldset>
                    <legend>Current Residence</legend>
                    <label for="current_address_${adultCount}">Current Address:</label>
                    <input type="text" id="current_address_${adultCount}" name="current_address[]" required>
                    
                    <label for="current_rent_${adultCount}">Current Rent Amount:</label>
                    <input type="number" id="current_rent_${adultCount}" name="current_rent[]" required>
                    
                    <label for="current_landlord_${adultCount}">Current Landlord's Name:</label>
                    <input type="text" id="current_landlord_${adultCount}" name="current_landlord[]" required>
                    
                    <label for="landlord_phone_${adultCount}">Current Landlord's Phone:</label>
                    <input type="tel" id="landlord_phone_${adultCount}" name="landlord_phone[]" required>
                    
                    <label for="reason_for_leaving_${adultCount}">Reason for Leaving:</label>
                    <textarea id="reason_for_leaving_${adultCount}" name="reason_for_leaving[]" required></textarea>
                </fieldset>

                <fieldset>
                    <legend>Section 8 Housing Voucher</legend>
                    <label for="section8_${adultCount}">Do you have a Section 8 Housing Voucher?</label>
                    <select id="section8_${adultCount}" name="section8[]" onchange="toggleSection8Fields(this)">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>

                    <div class="section8-fields conditional-section">
                        <label for="voucher_amount_${adultCount}">Voucher Amount:</label>
                        <input type="number" id="voucher_amount_${adultCount}" name="voucher_amount[]">
                        
                        <label for="voucher_case_worker_${adultCount}">Case Worker’s Name:</label>
                        <input type="text" id="voucher_case_worker_${adultCount}" name="voucher_case_worker[]">
                        
                        <label for="case_worker_phone_${adultCount}">Case Worker’s Phone:</label>
                        <input type="tel" id="case_worker_phone_${adultCount}" name="case_worker_phone[]">
                    </div>
                </fieldset>

                <fieldset>
                    <legend>Legal and Background Information</legend>
                    <label for="eviction_history_${adultCount}">Have you ever been evicted?</label>
                    <select id="eviction_history_${adultCount}" name="eviction_history[]" required>
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                    
                    <label for="bankruptcy_history_${adultCount}">Have you ever filed for bankruptcy?</label>
                    <select id="bankruptcy_history_${adultCount}" name="bankruptcy_history[]" required>
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                    
                    <label for="criminal_history_${adultCount}">Do you have any criminal convictions?</label>
                    <select id="criminal_history_${adultCount}" name="criminal_history[]" required>
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                    
                    <label for="additional_info_${adultCount}">Additional Information:</label>
                    <textarea id="additional_info_${adultCount}" name="additional_info[]"></textarea>
                </fieldset>

                <button type="button" class="remove-button" onclick="removeAdult(this)">Remove This Adult</button>
            `;
            document.getElementById('adultsSection').appendChild(newAdultSection);
            updateTotalFee();
        });

        function updateTotalFee() {
            const totalFee = adultCount * feePerAdult;
            document.getElementById('totalFee').innerText = totalFee;
        }

        function toggleEmploymentFields(selectElement) {
            const employmentFields = selectElement.parentNode.querySelector('.employment-fields');
            if (selectElement.value === 'yes') {
                employmentFields.style.display = 'block';
            } else {
                employmentFields.style.display = 'none';
            }
        }

        function toggleSection8Fields(selectElement) {
            const section8Fields = selectElement.parentNode.querySelector('.section8-fields');
            if (selectElement.value === 'yes') {
                section8Fields.style.display = 'block';
            } else {
                section8Fields.style.display = 'none';
            }
        }

        function togglePetDetails(selectElement) {
            const petDetails = selectElement.parentNode.querySelector('.conditional-section');
            if (selectElement.value === 'yes') {
                petDetails.style.display = 'block';
            } else {
                petDetails.style.display = 'none';
            }
        }

        function toggleMinorDetails(selectElement) {
            const minorDetails = selectElement.parentNode.querySelector('.conditional-section');
            if (selectElement.value === 'yes') {
                minorDetails.style.display = 'block';
            } else {
                minorDetails.style.display = 'none';
            }
        }

        function removeAdult(button) {
            const adultSection = button.parentNode;
            adultSection.remove();
            adultCount--;
            updateTotalFee();
        }

        const form = document.getElementById('rentalForm');
        form.addEventListener('submit', async (e) => {
            e.preventDefault();

            const { paymentMethod, error } = await stripe.createPaymentMethod('card', cardElement, {
                billing_details: {
                    name: form.full_name_1.value,
                    email: form.email_1.value
                }
            });

            if (error) {
                // Handle error
                document.getElementById('card-errors').textContent = error.message;
            } else {
                // Handle successful payment method creation
                fetch('process_application.php', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        paymentMethodId: paymentMethod.id,
                        full_name: form.full_name.value,
                        email: form.email.value,
                        phone: form.phone.value,
                        dob: form.dob.value,
                        ssn_itin: form.ssn_itin.value,
                        drivers_license: form.drivers_license.value,
                        current_address: form.current_address.value,
                        current_rent: form.current_rent.value,
                        current_landlord: form.current_landlord.value,
                        landlord_phone: form.landlord_phone.value,
                        reason_for_leaving: form.reason_for_leaving.value,
                        employed: form.employed.value,
                        employer: form.employer.value,
                        employer_address: form.employer_address.value,
                        position: form.position.value,
                        salary: form.salary.value,
                        employment_duration: form.employment_duration.value,
                        supervisor_name: form.supervisor_name.value,
                        supervisor_phone: form.supervisor_phone.value,
                        section8: form.section8.value,
                        voucher_amount: form.voucher_amount.value,
                        voucher_case_worker: form.voucher_case_worker.value,
                        case_worker_phone: form.case_worker_phone.value,
                        eviction_history: form.eviction_history.value,
                        bankruptcy_history: form.bankruptcy_history.value,
                        criminal_history: form.criminal_history.value,
                        additional_info: form.additional_info.value,
                        signature: form.signature.value,
                        application_date: form.application_date.value,
                        proof_of_income: form.proof_of_income.files,
                        bank_statements: form.bank_statements.files,
                        other_documents: form.other_documents.files,
                        totalFee: document.getElementById('totalFee').innerText
                    })
                }).then(response => response.json())
                  .then(result => {
                      if (result.success) {
                          alert('Application submitted successfully!');
                      } else {
                          alert('Error submitting application.');
                      }
                  });
            }
        });
    </script>
</body>
</html>